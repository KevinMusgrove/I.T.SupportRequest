(window["webpackJsonpsupport-request"]=window["webpackJsonpsupport-request"]||[]).push([[0],{137:function(e,t,a){e.exports=a(249)},142:function(e,t,a){},249:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(9),i=a.n(s),o=(a(142),a(2)),c=a.n(o),l=a(25),u=a(6),p=a(8),m=a(23),h=a(22),d=a(24),b=a(132),f=a(45),g=a(257),v=a(14),y=a(263),E=a(251),w=a(252),O=a(253),N=a(254),k=a(255),V=a(256),x=a(258),P=a(259),L=a(260),j=a(261);a(144);function S(e){return e.avatar?r.a.createElement("img",{src:e.avatar,alt:"user",className:"rounded-circle align-self-center mr-2",style:{width:"32px"}}):r.a.createElement("i",{className:"far fa-user-circle fa-lg rounded-circle align-self-center mr-2",style:{width:"32px"}})}function A(e){return e.isAuthenticated?r.a.createElement(y.a,null,r.a.createElement(E.a,{nav:!0,caret:!0},r.a.createElement(S,{user:e.user,avatar:e.avatar})),r.a.createElement(w.a,{right:!0},r.a.createElement("h5",{className:"dropdown-item-text mb-0"},e.user.displayName),r.a.createElement("p",{className:"dropdown-item-text text-muted mb-0"},e.user.email),r.a.createElement(O.a,{divider:!0}),r.a.createElement(O.a,{onClick:e.authButtonMethod},"Sign Out"))):r.a.createElement(N.a,null,r.a.createElement(k.a,{onClick:e.authButtonMethod},"Sign In"))}var I=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).toggle=a.toggle.bind(Object(v.a)(a)),a.state={isOpen:!1},a}return Object(d.a)(t,e),Object(p.a)(t,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(V.a,{color:"dark",dark:!0,expand:"md",fixed:"top"},r.a.createElement(g.a,null,r.a.createElement(x.a,{href:"/",style:{fontWeight:"500"}},"I.T. Support Request"),r.a.createElement(P.a,{onClick:this.toggle}),r.a.createElement(L.a,{isOpen:this.state.isOpen,navbar:!0},r.a.createElement(j.a,{className:"mr-auto",navbar:!0}),r.a.createElement(j.a,{className:"justify-content-end",navbar:!0},r.a.createElement(A,{isAuthenticated:this.props.isAuthenticated,authButtonMethod:this.props.authButtonMethod,user:this.props.user,avatar:this.props.avatar}))))))}}]),t}(r.a.Component),C=a(264),M=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=null;return this.props.debug&&(e=r.a.createElement("pre",{className:"alert-pre border bg-light p-2"},r.a.createElement("code",null,this.props.debug))),r.a.createElement(C.a,{color:"danger"},r.a.createElement("p",{className:"mb-3"},this.props.message),e)}}]),t}(r.a.Component),B=a(119),F=(a(155),a(248));function D(e){return F.Client.init({authProvider:function(t){t(null,e.accessToken)}})}function T(e,t,a,n,r,s,i,o,c,l,u){return U.apply(this,arguments)}function U(){return(U=Object(l.a)(c.a.mark(function e(t,a,n,r,s,i,o,l,u,p,m){var h,d,b;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h=D(t),p,d=p?{message:{subject:"New Support Request",attachments:m,body:{contentType:"Html",content:'<body style="font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; padding:5px;">\n            <span style="font-weight: bold">User Having Issue: </span>'.concat(a," ").concat(n,'\n            <br/>\n            <span style="font-weight: bold">User\'s Location: </span>').concat(r,'\n            <br/>\n            <span style="font-weight: bold">User\'s Email: </span>').concat(s,'<a href="mailto:').concat(s,'"></a>\n            <br/>\n            <span style="font-weight: bold">User\'s Phone Number: </span><a href="tel:').concat(i,'">').concat(i,'</a>\n            <br/>\n            <span style="font-weight: bold">Type of Device with Issue:</span> ').concat(o,'\n            <br/>\n            <span style="font-weight: bold">Priority Level:</span> ').concat(l,'\n            <br/><br/>\n            <span style="font-weight: bold">Issue Description:</span> ').concat(u,"\n            </body>")},toRecipients:[{emailAddress:{address:"Kevin.Musgrove@atb-tech.com"}}],ccRecipients:[{emailAddress:{address:p}}]},saveToSentItems:"true"}:{message:{subject:"New Support Request",attachments:m,body:{contentType:"Html",content:'<body style="font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; padding:5px;">\n            <span style="font-weight: bold">User Having Issue: </span>'.concat(a," ").concat(n,'\n            <br/>\n            <span style="font-weight: bold">User\'s Location: </span>').concat(r,'\n            <br/>\n            <span style="font-weight: bold">User\'s Email: </span>').concat(s,'<a href="mailto:').concat(s,'"></a>\n            <br/>\n            <span style="font-weight: bold">User\'s Phone Number: </span><a href="tel:').concat(i,'">').concat(i,'</a>\n            <br/>\n            <span style="font-weight: bold">Type of Device with Issue:</span> ').concat(o,'\n            <br/>\n            <span style="font-weight: bold">Priority Level:</span> ').concat(l,'\n            <br/><br/>\n            <span style="font-weight: bold">Issue Description:</span> ').concat(u,"\n            </body>")},toRecipients:[{emailAddress:{address:"Kevin.Musgrove@atb-tech.com"}}]},saveToSentItems:"true"},e.next=6,h.api("/me/sendMail").post(d);case 6:return b=e.sent,e.abrupt("return",b);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function q(e){return R.apply(this,arguments)}function R(){return(R=Object(l.a)(c.a.mark(function e(t){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://graph.microsoft.com/beta/me/photo/$value",{headers:{Authorization:"Bearer "+t}}).then(function(){var e=Object(l.a)(c.a.mark(function e(t){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!=t.status){e.next=7;break}return e.next=3,t.blob();case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.abrupt("return","");case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function z(e){return H.apply(this,arguments)}function H(){return(H=Object(l.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=D(t),e.next=4,a.api("/me/manager").get();case 4:if(!(n=e.sent)){e.next=7;break}return e.abrupt("return",n.mail);case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return","");case 12:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}function W(e){return G.apply(this,arguments)}function G(){return(G=Object(l.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=D(t),e.next=3,a.api("/me").get();case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var J=a(54),K=a.n(J),$=a(73),_=(a(164),a(121)),Q=a.n(_),X=a(122),Y=a.n(X),Z=(a(165),a(57)),ee=(a(166),a(167),a(123)),te=a.n(ee),ae=a(262),ne=r.a.createRef();Object($.registerPlugin)(Q.a),Object($.registerPlugin)(Y.a);var re=ae.a.Option,se=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).devices=["Laptop","Desktop","Monitor","Bluetooth headset","Wired headset","Cell phone","Desk phone","Keyboard","Mouse","Speakers","Printer","Tablet","Not listed"],a.locations=["Location 1"," Location 2"," Location 3"],a.priorites=["High","Medium","Low"],a.selectDevice=function(e){a.setState(function(t,a){return{isLoading:t.isLoading,priorityValue:t.priorityValue,locationValue:t.locationValue,phoneValue:t.phoneValue,deviceValue:e}})},a.selectLocation=function(e){a.setState(function(t,a){return{isLoading:t.isLoading,priorityValue:t.priorityValue,deviceValue:t.deviceValue,phoneValue:t.phoneValue,locationValue:e}})},a.selectPriority=function(e){a.setState(function(t,a){return{isLoading:t.isLoading,deviceValue:t.deviceValue,locationValue:t.locationValue,phoneValue:t.phoneValue,priorityValue:e}})},a.selectPhone=function(e){a.setState(function(t,a){return{isLoading:t.isLoading,deviceValue:t.deviceValue,locationValue:t.locationValue,priorityValue:t.priorityValue,phoneValue:e}})},a.submitFormMethod=a.submitFormMethod.bind(Object(v.a)(a)),a.ClearForm=a.ClearForm.bind(Object(v.a)(a)),a.selectDevice=a.selectDevice.bind(Object(v.a)(a)),a.selectPriority=a.selectPriority.bind(Object(v.a)(a)),a.selectLocation=a.selectLocation.bind(Object(v.a)(a)),a.selectPhone=a.selectPhone.bind(Object(v.a)(a)),a.state={isLoading:!1,deviceValue:"",priorityValue:"Medium",locationValue:"",phoneValue:""},a}return Object(d.a)(t,e),Object(p.a)(t,[{key:"submitFormMethod",value:function(){var e=Object(l.a)(c.a.mark(function e(t,a){var n,r,s,i,o,l,u,p,m,h,d;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),e.next=4,a.UserAgentApplication.acquireTokenSilent({scopes:K.a.scopes});case 4:if(!(n=e.sent)){e.next=29;break}if(this.setState({isLoading:!0}),r=document.getElementById("tbFirstname").value,s=document.getElementById("tbLastname").value,i=document.getElementById("tbEmail").value,o=document.getElementById("tbIssueDesc").value,l=this.state.locationValue,u=this.state.phoneValue||this.props.user.cellPhone||this.props.user.bussinessPhone||document.getElementById("tbPhone").value,p=this.state.deviceValue,m=this.state.priorityValue,h=ne.current.getFiles(),d=[],""!=r.trim()&&""!=s.trim()&&""!=l.trim()&&""!=i.trim()&&""!=u.trim()&&""!=p.trim()&&""!=m.trim()&&""!=o.trim()){e.next=21;break}return Z.a.error("Error: Please fill out all required fields."),this.setState({isLoading:!1}),e.abrupt("return");case 21:return h.forEach(function(e){d.push({"@odata.type":"#microsoft.graph.fileAttachment",name:"".concat(e.filename),contentBytes:"".concat(e.getFileEncodeBase64String())})}),e.next=24,T(n,r,s,l,i,u,p,m,o,a.managerEmail,d);case 24:Z.a.configure({autoClose:3e3,width:275,position:"top-right",delay:0,closeOnClick:!0,pauseOnHover:!0,onlyLast:!1,rtl:!1,newestOnTop:!0,animation:{in:"zoomIn",out:"zoomOut",duration:400}}),Z.a.success("Request successfully sent."),this.ClearForm(),e.next=30;break;case 29:a.authButtonMethod();case 30:e.next=38;break;case 32:e.prev=32,e.t0=e.catch(0),Z.a.configure({autoClose:3e3,width:275,position:"top-right",delay:0,closeOnClick:!0,pauseOnHover:!0,onlyLast:!1,rtl:!1,newestOnTop:!0,animation:{in:"zoomIn",out:"zoomOut",duration:400}}),Z.a.error("Error:  ".concat(e.t0.body)),this.setState({isLoading:!1});case 38:case"end":return e.stop()}},e,this,[[0,32]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"ClearForm",value:function(){var e=document.getElementById("tbPhone");e&&(e.value=""),this.setState({isLoading:!1,deviceValue:"",priorityValue:"Medium",locationValue:"",phoneValue:""}),document.getElementById("tbIssueDesc").value="",0!=ne.current.getFiles().length&&ne.current.getFiles().forEach(function(e){ne.current.removeFile(e)})}},{key:"render",value:function(){var e=this;return console.log(this.props.user),this.props.isAuthenticated?r.a.createElement("div",null,r.a.createElement("h4",{className:"display-10 text-center mb-3",id:"appHeader"},"New I.T. Support Request"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"inputLabel"},"* First Name"),r.a.createElement("input",{type:"text",className:"form-control",id:"tbFirstname",defaultValue:this.props.user.firstName,placeholder:"First Name",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"inputLabel"},"* Last Name"),r.a.createElement("input",{type:"text",className:"form-control",id:"tbLastname",defaultValue:this.props.user.lastName,placeholder:"Last Name",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"inputLabel"},"* Email"),r.a.createElement("input",{type:"text",className:"form-control",id:"tbEmail",defaultValue:this.props.user.email,placeholder:"Email",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"inputLabel"},"* Phone"),this.props.user.cellPhone&&this.props.user.bussinessPhone?r.a.createElement(ae.a,{value:this.state.phoneValue||this.props.user.cellPhone||this.props.user.bussinessPhone,defaultValue:this.props.user.cellPhone||this.props.user.bussinessPhone,showSearch:!0,size:"large",placeholder:"Select Phone Number",filterOption:!0,onChange:this.selectPhone,style:{width:"100%"}},r.a.createElement(re,{key:this.props.user.cellPhone},this.props.user.cellPhone),r.a.createElement(re,{key:this.props.user.bussinessPhone},this.props.user.bussinessPhone)):r.a.createElement("input",{type:"text",className:"form-control",id:"tbPhone",defaultValue:this.props.user.cellPhone||this.props.user.bussinessPhone,placeholder:"Phone Number",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"inputLabel"},"* Location"),r.a.createElement(ae.a,{value:this.state.locationValue,showSearch:!0,size:"large",placeholder:"Select Location",filterOption:!0,onChange:this.selectLocation,style:{width:"100%"}},this.locations.map(function(e){return r.a.createElement(re,{key:e},e)}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"inputLabel"},"* Issue Priority"),r.a.createElement(ae.a,{value:this.state.priorityValue,defaultValue:"Medium",showSearch:!0,size:"large",placeholder:"Select Priority Level",filterOption:!0,onChange:this.selectPriority,style:{width:"100%"}},this.priorites.map(function(e){return r.a.createElement(re,{key:e},e)}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"inputLabel"},"* Device with Issue"),r.a.createElement(ae.a,{value:this.state.deviceValue,showSearch:!0,size:"large",placeholder:"Select Device",filterOption:!0,onChange:this.selectDevice,style:{width:"100%"}},this.devices.map(function(e){return r.a.createElement(re,{key:e},e)}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"inputLabel"},"* Issue Description"),r.a.createElement("textarea",{className:"form-control",rows:"3",id:"tbIssueDesc",placeholder:"Issue Description",required:!0})),r.a.createElement("label",{className:"inputLabel"},"Attachments"),r.a.createElement($.FilePond,{id:"fileControl",allowMultiple:!0,ref:ne}),r.a.createElement(te.a,{type:"TailSpin",color:"lightGray",height:50,width:50,className:"loader",visible:this.state.isLoading}),r.a.createElement("div",{className:"text-center mb-3",id:"btnSection"},r.a.createElement("input",{type:"button",value:"Reset Form",id:"btnClear",onClick:function(){return e.ClearForm()},className:"btn btn-danger"}),r.a.createElement("input",{type:"submit",value:"Submit Form",id:"btnSubmit",onClick:function(t){return e.submitFormMethod(t,e.props)},className:"btn btn-primary"}))))))):r.a.createElement("div",{id:"signIn"},r.a.createElement(B.a,{id:"btnSignInMain",onClick:this.props.authButtonMethod},"Sign in with Microsoft"))}}]),t}(r.a.Component),ie=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(se,{isAuthenticated:this.props.isAuthenticated,user:this.props.user,managerEmail:this.props.managerEmail,UserAgentApplication:this.props.UserAgentApplication,authButtonMethod:this.props.authButtonMethod}))}}]),t}(r.a.Component),oe=(a(242),a(135)),ce=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).userAgentApplication=new oe.a({auth:{clientId:K.a.appId},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}});var n=a.userAgentApplication.getAccount();return a.state={isAuthenticated:null!==n,user:{},files:{},avatar:"",managerEmail:"",error:null},n&&a.getUserProfile(),a}return Object(d.a)(t,e),Object(p.a)(t,[{key:"login",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.loginPopup({scopes:K.a.scopes,prompt:"select_account"});case 3:return e.next=5,this.getUserProfile();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),"user_cancelled"!==e.t0.errorCode&&(t=e.t0.split("|"),this.setState({isAuthenticated:!1,user:{},avatar:"",files:{},error:{message:t[1],debug:t[0]}}));case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.userAgentApplication.logout()}},{key:"getUserProfile",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,a,n,r,s,i,o,l=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.acquireTokenSilent({scopes:K.a.scopes});case 3:if(!(t=e.sent)){e.next=16;break}return e.next=7,W(t);case 7:return a=e.sent,e.next=10,z(t);case 10:return n=e.sent,e.next=13,q(t.accessToken);case 13:(r=e.sent)&&((s=new FileReader).readAsDataURL(r),s.onloadend=function(e){var t=s.result;l.setState({avatar:t})}),this.setState({isAuthenticated:!0,user:{firstName:a.givenName,lastName:a.surname,displayName:a.displayName,email:a.mail||a.userPrincipalName,cellPhone:a.mobilePhone,bussinessPhone:a.businessPhones[0]||null},error:null,managerEmail:n});case 16:e.next=23;break;case 18:e.prev=18,e.t0=e.catch(0),i={},"string"===typeof e.t0?(o=e.t0.split("|"),i=o.length>1?{message:o[1],debug:o[0]}:{message:e.t0}):i={message:e.t0.message,debug:JSON.stringify(e.t0)},this.setState({isAuthenticated:!1,user:{},error:i});case 23:case"end":return e.stop()}},e,this,[[0,18]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=null;return this.state.error&&(t=r.a.createElement(M,{message:this.state.error.message,debug:this.state.error.debug})),r.a.createElement(b.a,null,r.a.createElement("div",null,r.a.createElement(I,{isAuthenticated:this.state.isAuthenticated,authButtonMethod:this.state.isAuthenticated?this.logout.bind(this):this.login.bind(this),user:this.state.user,avatar:this.state.avatar}),r.a.createElement(g.a,null,t,r.a.createElement(f.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(ie,Object.assign({},t,{isAuthenticated:e.state.isAuthenticated,UserAgentApplication:e.userAgentApplication,user:e.state.user,managerEmail:e.state.managerEmail,files:e.state.files,authButtonMethod:e.login.bind(e)}))}}))))}},{key:"setErrorMessage",value:function(e,t){this.setState({error:{message:e,debug:t}})}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},54:function(e,t){e.exports={appId:"271c203f-7708-4184-a030-0e2cdfdabbfe",scopes:["user.ReadWrite.All","Mail.Send"]}}},[[137,1,2]]]);
//# sourceMappingURL=main.88ba9e60.chunk.js.map